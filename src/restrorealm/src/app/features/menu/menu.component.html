<div class="menu-container">
    <!-- Header Section -->
    <div class="menu-header">
        <h1>Menu Management</h1>
        <div class="menu-actions">
            <div class="search-box">
                <input 
                    type="text" 
                    [(ngModel)]="searchTerm" 
                    (input)="onSearch()" 
                    placeholder="Search menu items..."
                />
            </div>
            <button 
                *ngIf="hasPermission('CREATE_MENU_ITEM')"
                class="btn-primary" 
                (click)="openCreateDialog()">
                <i class="fas fa-plus"></i> Add Item
            </button>
        </div>
    </div>

    <!-- Categories Section -->
    <div class="categories-section">
        <button 
            *ngFor="let category of categories" 
            [class.active]="selectedCategory === category"
            (click)="filterByCategory(category)">
            {{ category.name }}
        </button>
    </div>

    <!-- Menu Items Grid -->
    <div class="menu-grid">
        <div *ngFor="let item of filteredMenuItems" class="menu-item-card">
            <img [src]="item.imageUrl" [alt]="item.name"/>
            <div class="item-details">
                <h3>{{ item.name }}</h3>
                <p>{{ item.description }}</p>
                <p class="price">${{ item.price }}</p>
            </div>
            <div class="item-actions">
                <button 
                    *ngIf="hasPermission('READ_SINGLE_MENU_ITEM')"
                    (click)="viewDetails(item)">
                    <i class="fas fa-eye"></i>
                </button>
                <button 
                    *ngIf="hasPermission('UPDATE_SINGLE_MENU_ITEM')"
                    (click)="openEditDialog(item)">
                    <i class="fas fa-edit"></i>
                </button>
                <button 
                    *ngIf="hasPermission('DELETE_MENU_ITEM')"
                    (click)="deleteItem(item)">
                    <i class="fas fa-trash"></i>
                </button>
            </div>
        </div>
    </div>

    <!-- Create/Edit Dialog -->
    <div class="dialog" *ngIf="showDialog">
        <div class="dialog-content">
            <h2>{{ editingItem ? 'Edit' : 'Create' }} Menu Item</h2>
            <form [formGroup]="menuForm" (ngSubmit)="onSubmit()">
                <div class="form-group">
                    <label>Name</label>
                    <input type="text" formControlName="name"/>
                </div>
                <div class="form-group">
                    <label>Description</label>
                    <textarea formControlName="description"></textarea>
                </div>
                <div class="form-group">
                    <label>Price</label>
                    <input type="number" formControlName="price"/>
                </div>
                <div class="form-group">
                    <label>Category</label>
                    <select formControlName="categoryId">
                        <option *ngFor="let cat of categories" [value]="cat.id">
                            {{ cat.name }}
                        </option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Image</label>
                    <input type="file" (change)="onImageSelect($event)"/>
                </div>
                <div class="dialog-actions">
                    <button type="button" (click)="closeDialog()">Cancel</button>
                    <button type="submit" [disabled]="menuForm.invalid || loading">
                        {{ loading ? 'Saving...' : 'Save' }}
                    </button>
                </div>
            </form>
        </div>
    </div>
    <app-toaster *ngIf="toast" [message]="toast.message" [type]="toast.type"></app-toaster>
</div>
